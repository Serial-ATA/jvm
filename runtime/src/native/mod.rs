#![allow(non_snake_case)]

use crate::stack::local_stack::LocalStack;

use std::collections::HashMap;

use classfile::types::u1;
use once_cell::sync::Lazy;

mod java;

#[derive(Eq, Hash, PartialEq)]
pub struct NativeMethodDef<'a> {
	pub class: &'a [u1],
	pub name: &'a [u1],
	pub descriptor: &'a [u1],
}

pub type NativeMethodPtr = fn(LocalStack);

include!("native_init.rs"); // Provides `init_native_method_table()`, generated by `runtime/build.rs`
pub(self) static NATIVE_METHOD_TABLE: Lazy<HashMap<NativeMethodDef<'static>, NativeMethodPtr>> =
	Lazy::new(|| init_native_method_table());

pub fn lookup_method(def: NativeMethodDef<'_>) -> NativeMethodPtr {
	NATIVE_METHOD_TABLE[&def]
}
